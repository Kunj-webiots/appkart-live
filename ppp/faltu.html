<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>No Notification Page</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f5f5f5;
      color: #333;
      padding: 20px;
    }
    .ok {
      background: #d4edda;
      color: #155724;
      padding: 10px;
      border-radius: 6px;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>

  <h1>Safe Page – No Notifications</h1>
  <div id="status" class="ok">
    ✅ Notifications disabled for this page.
  </div>

  <script>
    // --- 1. Block Notification API calls ---
    if ("Notification" in window) {
      // Override requestPermission to prevent popup
      Notification.requestPermission = function() {
        console.warn("Notification permission request blocked.");
        return Promise.resolve("denied");
      };
    }

    // --- 2. Unregister existing Service Workers (if any) ---
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.getRegistrations().then(function(regs) {
        if (regs.length > 0) {
          regs.forEach(reg => reg.unregister().then(() => {
            console.log("Service worker unregistered:", reg);
          }));
        }
      });
    }

    // --- 3. Block PushManager subscribe if script tries ---
    if ('PushManager' in window) {
      const origSubscribe = PushManager.prototype.subscribe;
      PushManager.prototype.subscribe = function() {
        console.warn("Push subscription attempt blocked.");
        return Promise.reject(new Error("Push blocked"));
      };
    }

    // --- 4. Debug check if any script tries to use Notification API ---
    const notifProps = ["Notification", "PushManager"];
    notifProps.forEach(prop => {
      if (window[prop]) {
        console.log(`${prop} API found, but disabled for safety.`);
      }
    });
  </script>

</body>
</html>
